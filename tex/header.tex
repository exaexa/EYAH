\documentclass[10pt,a5paper]{book}
\usepackage[utf8]{inputenc}
\usepackage[sc]{mathpazo}
\linespread{1.05}
\usepackage[T1]{fontenc}
\usepackage{marginnote}
\usepackage{wasysym}
\let\Square\undefined
\usepackage{bbding}
\usepackage{keyval,xparse}
\usepackage{multido}
\usepackage{xspace}
\usepackage{hyperref}
\usepackage{cleveref}

\setlength{\marginparpush}{0pt}
\setlength{\marginparsep}{2em}

\title{Exercise Yourself a Haskell \\ \vspace{1em} \Large (For Great Profit)}
\date{}
%\author{People of the Internet}

%% Macro definitions here!

\newcommand{\startExercises}{\begin{description}}
\newcommand{\finishExercises}{\end{description}}

\makeatletter
\define@key{exerciseTag}{stars}{\def\exerciseTag@stars{#1}}
\define@key{exerciseTag}{lambdas}{\def\exerciseTag@lambdas{#1}}
\define@key{exerciseTag}{pencils}{\def\exerciseTag@pencils{#1}}
\define@key{exerciseTag}{trees}{\def\exerciseTag@trees{#1}}
\DeclareDocumentCommand\exerciseTag{m}{%
  \begingroup%
  \setkeys{exerciseTag}{stars={0},lambdas={0},pencils={0},trees={0},#1}%
  \marginnote{
  \multido{}{\exerciseTag@stars}{\FiveStar}
  \multido{}{\exerciseTag@pencils}{\PencilLeftDown}
  \multido{}{\exerciseTag@lambdas}{{\large $\lambda$}}
  }[0pt]
  \endgroup%
}
\makeatother
\newcommand{\exercise}[3]{\item[#2] \exerciseTag{#1} #3}

%% Autorefs

\crefname{section}{\S}{\S}
\crefname{subsection}{\S}{\S}
\crefname{subsubsection}{\S}{\S}

%\renewcommand{\sectionautorefname}{\S}
%\renewcommand{\subsectionautorefname}{\S}
%\renewcommand{\subsubsectionautorefname}{\S}

%% Some relatively useful definitions

\newcommand{\eg}{e.\,g.\xspace}
\newcommand{\ie}{i.\,e.\xspace}
\newcommand{\Eg}{E.\,g.\xspace}

%% Start of the main document.

\begin{document}
\sloppy

\maketitle

This book is intended as a collaborative project, everyone is welcome to
contribute at \url{https://github.com/exaexa/EYAH}.

For the reasons of great success, it is organized into chapters; the reader is
free to choose whichever chapter seems most suitable to exercise. Contents of
the chapters are usually meant as courses.

\Cref{chap:lyah} was originally meant to accompany the reading of the book
`Learn Yourself a Haskell.' In \cref{chap:mff} you will find collected
exercises as used on a university course in the middle of Europe. We also
expect parsing- and lens-oriented chapters to materialize.

Some exercises are marked by a variable number of badges:
\begin{itemize}
\item Stars \FiveStar\ will be found near any exercise that is worthy a bit of
thinking.
\item Pencils \PencilLeftDown\ accompany exercises that attempt to improve
the technical background of the reader, at the cost of some extra coding work.
\item Lambdas {\large $\lambda$} mark exercises that carry some reasonable
connection to underlying logic or $\lambda$-calculus.
\end{itemize}
Other tags will probably appear as well.

